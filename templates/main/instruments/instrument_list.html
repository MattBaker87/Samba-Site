{% extends "main/base_new.html" %}

{% block title %}Instrument list{% endblock %}

{% block nav %}
    {% with "instruments" as active %}
        {% include 'main/nav.html' %}
    {% endwith %}
{% endblock %}

{% block top %}
    <h1>Instrument list</h1>
    {% load get_instruments %}
    {% get_instruments as instrument_list %}
    <table class="zebra-striped">
        <thead>
            <tr>
                <th>Instrument</th>
                <th></th>
                <th>Type</th>
                <th>Location</th>
                <th>Last user</th>
                <th>Next user</th>
            </tr>
        </thead>
        <tbody>
            {% for instrument in instrument_list %}
                <tr>
                    <td><a href="{{ instrument.get_absolute_url }}">{{ instrument.name }}</a></td>
                    <td>{% if instrument.damaged %}<span class="label important">Damaged</span>{% endif %}</td>
                    <td>{{ instrument.get_instrument_type_display }}</td>
                    <td>{{ instrument.location }}</td>
                    {% with instrument.last_booking as b %}
                        <td>{% if b %}{{ b.user.get_profile.name }} at <a href="{{ b.event.get_absolute_url }}">{{ b.event.name }}</a>{% else %}Brand new!{% endif %}</td>
                    {% endwith %}
                    {% with instrument.next_booking as b %}
                        <td>{% if b %}{{ b.user.get_profile.name }} at <a href="{{ b.event.get_absolute_url }}">{{ b.event.name }}</a>{% else %}No future bookings{% endif %}</td>
                    {% endwith %}
                </tr>
            {% endfor %}
            <tr>
                <td colspan="8">
                    <a href="{% url instrument_add %}" class="btn success">Add instrument</a>
                </td>
            </tr>
        </tbody>
    </table>
{% endblock %}

{% block bottom %}
    <ul class="breadcrumb">
    	<li>
    		<a href="{% url home %}">Home</a>
    		<span class="divider">/</span>
    	</li>
    	<li class="active">
    	    <a href="#">Instruments</a>
    	</li>
    </ul>
{% endblock %}

{% block wireframe_content %}
    <ul>
        <li>TODO after adding ability to sign instruments back int
            <ul>
                <li>Put sign-in link on this page</li>
            </ul>
        </li>
        <li>TODO low priority
            <ul>
                <li>Add buttons for admins to delete and edit instruments from here</li>
                <li>Should we display notes about instruments here? Consider after adding facility to write notes</li>
            </ul>
        </li>
    </ul>
{% endblock %}

{% block wireframe_links %}
    <ul>
        <li><a href="{% url instrument_signin %}">Sign instrument back in</a></li>
    </ul>
{% endblock %}