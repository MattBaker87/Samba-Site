{% extends "main/base_new.html" %}

{% block title %}Instruments{% endblock %}

{% block nav %}
    {% with "instruments" as active %}
        {% include 'main/nav.html' %}
    {% endwith %}
{% endblock %}

{% block top %}
    <h1>Instruments <small>owned by the band</small></h1>
    {% load get_instruments %}
    {% get_instruments as instrument_list %}
    <table class="zebra-striped">
        <thead>
            <tr>
                <th>Instrument name</th>
                <th></th>
                <th>Type</th>
                <th>Location</th>
                <th>Last user</th>
                <th>Next user</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            {% for instrument in instrument_list %}
                <tr>
                    <td>{{ instrument.get_linked_name }}</td>
                    <td>{% if instrument.damaged %}<span class="label important">Damaged</span>{% endif %}</td>
                    <td>{{ instrument.get_instrument_type_display }}</td>
                    <td>{{ instrument.get_location }}</td>
                    {% with instrument.get_last_booking as b %}
                        <td>{% if b %}{{ b.user.get_profile.get_linked_name }} at {{ b.event.get_linked_name }}{% else %}Brand new!{% endif %}</td>
                    {% endwith %}
                    {% with instrument.get_next_booking as b %}
                        <td>{% if b %}{{ b.user.get_profile.get_linked_name }} at {{ b.event.get_linked_name }}{% else %}No future bookings{% endif %}</td>
                    {% endwith %}
                    <td>
                        {% if user in instrument.get_users_since_signed_in %}
                            <a href="{{ instrument.get_signin_url }}" class="success btn-inline btn">Sign in</a>
                        {% endif %}
                    </td>
                </tr>
            {% endfor %}
        </tbody>
        <thead>
            <tr>
                <td colspan="8">
                    <a href="{% url instrument_add %}" class="btn success">Add instrument</a>
                </td>
            </tr>
        </thead>
    </table>
{% endblock %}

{% block bottom %}
    <ul class="breadcrumb">
    	<li>
    		<a href="{% url home %}">Home</a>
    		<span class="divider">/</span>
    	</li>
    	<li class="active">
    	    <a href="#">Instruments</a>
    	</li>
    </ul>
{% endblock %}

{% block wireframe_content %}
    <ul>
        <li>TODO low priority
            <ul>
                <li>Add buttons for admins to delete and edit instruments from here</li>
                <li>Should we display notes about instruments here? Consider after adding facility to write notes</li>
            </ul>
        </li>
    </ul>
{% endblock %}

{% block wireframe_links %}
{% endblock %}